# Аугментация изображений с использованием Keras

Этот репозиторий содержит код для выполнения аугментации изображений с использованием Keras. Применяемые аугментации включают вертикальное отражение, горизонтальное отражение и изменение контраста. Эти аугментации могут помочь улучшить устойчивость моделей машинного обучения, предоставляя более разнообразные данные для обучения.

Вы можете установить необходимые пакеты, используя следующую команду:

`pip install -r requirements.txt`

## Для классов 0 и 1

Исходное соотноения класса 0:1 **11% : 89%**

Для класса 0:
1. Исходных изображений 76
2. По вертикали 76
3. По горизонтали 76
4. Контраст 76
5. Вертикаль-контраст 76
6. Горизонталь-контраст 76

Итого: 76*6 = 456

Итоговое соотношение **42,7% : 57,3%**

### Модели

**Resnet**

Оптимизатор Adam 

train Loss: 0.0372 Acc: 0.9875 Prec: 0.9947 Rec: 0.9843 F1: 0.9894

val Loss: 0.0266 Acc: 0.9860 Prec: 1.0000 Rec: 0.9732 F1: 0.9864

Test Accuracy: 0.9626 Prec: 1.0000 Rec: 0.9328 F1: 0.9652

Наблюдается ошибки первого рода : ложноотрицательные (изображение с ретинопатией отнесено к здоровым)


**effectivenet**

Оптимизатор Adam 

train Loss: 0.0101 Acc: 0.9984 Prec: 0.9974 Rec: 1.0000 F1: 0.9987

val Loss: 0.0002 Acc: 1.0000 Prec: 1.0000 Rec: 1.0000 F1: 1.0000

Test Accuracy: 1.0000 Prec: 1.0000 Rec: 1.0000 F1: 1.0000

**DenseNet121**

Оптимизатор Adam 

train Loss: 0.0904 Acc: 0.9625 Prec: 0.9661 Rec: 0.9711 F1: 0.9686

val Loss: 0.0909 Acc: 0.9626 Prec: 1.0000 Rec: 0.9286 F1: 0.9630

Test Accuracy: 0.9673 Prec: 1.0000 Rec: 0.9412 F1: 0.9697

Наблюдается ошибки первого рода : ложноотрицательные (изображение с ретинопатией отнесено к здоровым)

## Для 3х классов: 

Исходное соотноения класса 0:1:2 **15% : 25% : 59%**

Для класса 0:
1. Исходных изображений 76
2. По вертикали 76
3. По горизонтали 76
4. Контраст 76
5. Вертикаль-контраст 76
6. Горизонталь-контраст 76

Итого: 76*6 = 456

Итоговое соотношение **51,9% : 14,3% : 33,8%**

### Модели

**Resnet**

Оптимизатор Adam 

train Loss: 0.0858 Acc: 0.9677 Prec: 0.9676 Rec: 0.9677 F1: 0.9677

val Loss: 3.4310 Acc: 0.5511 Prec: 0.7597 Rec: 0.5511 F1: 0.4242

Test Accuracy: 0.5227 Prec: 0.7558 Rec: 0.5227 F1: 0.3813

Наблюдается ошибки первого рода : ложноотрицательные (изображение с ретинопатией и плюс болезнь отнесены к здоровым)


**effectivenet**

Оптимизатор Adam 

train Loss: 0.0625 Acc: 0.9867 Prec: 0.9868 Rec: 0.9867 F1: 0.9867

val Loss: 0.1026 Acc: 0.9830 Prec: 0.9840 Rec: 0.9830 F1: 0.9829

Test Accuracy: 0.9830 Prec: 0.9828 Rec: 0.9830 F1: 0.9828

Путает плюс болезнь и 2-3 стадии

**DenseNet121**

Оптимизатор Adam 

train Loss: 0.0578 Acc: 0.9791 Prec: 0.9792 Rec: 0.9791 F1: 0.9790

val Loss: 0.1767 Acc: 0.9375 Prec: 0.9464 Rec: 0.9375 F1: 0.9374

Test Accuracy: 0.9375 Prec: 0.9378 Rec: 0.9375 F1: 0.9356

Нет закономерности, ошибки все со всеми


## Примечание

1. Для трехклассового датасета, можно снизить количество манипуляций с классом 0 для равного соотноения классов, или провести часть манипуляций для класса 1